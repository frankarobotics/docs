<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dynamics Model &mdash; Franka Control Interface (FCI) 0.6.0 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/style_override.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> Franka Control Interface (FCI)
            <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../overview.html">Franka Control Interface Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/index.html">libfranka client library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../franka_ros2/docs/index.html">franka_ros2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../franka_ros/docs/index.html">franka_ros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../franka_toolbox_for_matlab/docs/franka_matlab/index.html">Franka Toolbox for MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../compatibility.html">Software Versions Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../robot_specifications.html">Control Interface Specification and Robot Limits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../fr3-certification-remarks.html">FR3 certification remarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq.html">FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Franka Control Interface (FCI)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Dynamics Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/libfranka/pylibfranka/docs/api/model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dynamics-model">
<h1>Dynamics Model<a class="headerlink" href="#dynamics-model" title="Permalink to this heading"></a></h1>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code> class provides robot dynamics model for computing kinematics and dynamics quantities.</p>
<section id="class-definition">
<h2>Class Definition<a class="headerlink" href="#class-definition" title="Permalink to this heading"></a></h2>
</section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The Model class allows computation of various dynamics quantities including:</p>
<ul class="simple">
<li><p>Mass matrix</p></li>
<li><p>Coriolis and centrifugal forces</p></li>
<li><p>Gravity torques</p></li>
<li><p>Forward kinematics (Jacobian)</p></li>
</ul>
<p>To obtain a Model instance, use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Robot.load_model()</span></code>.</p>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading"></a></h2>
<section id="coriolis">
<h3>coriolis<a class="headerlink" href="#coriolis" title="Permalink to this heading"></a></h3>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">Model.</span></span><span class="sig-name descname"><span class="pre">coriolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">robot_state</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Compute Coriolis force vector <span class="math notranslate nohighlight">\(c(q, \dot{q})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>robot_state</strong> (<em>RobotState</em>) – Current robot state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coriolis force vector [Nm] as numpy array (7,)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p>The Coriolis vector represents centrifugal and Coriolis forces acting on the robot.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pylibfranka</span>

<span class="n">robot</span> <span class="o">=</span> <span class="n">pylibfranka</span><span class="o">.</span><span class="n">Robot</span><span class="p">(</span><span class="s2">&quot;172.16.0.2&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">load_model</span><span class="p">()</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">read_once</span><span class="p">()</span>

<span class="c1"># Compute Coriolis forces</span>
<span class="n">coriolis</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coriolis</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coriolis forces [Nm]:&quot;</span><span class="p">,</span> <span class="n">coriolis</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="gravity">
<h3>gravity<a class="headerlink" href="#gravity" title="Permalink to this heading"></a></h3>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">Model.</span></span><span class="sig-name descname"><span class="pre">gravity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">robot_state</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Compute gravity force vector <span class="math notranslate nohighlight">\(g(q)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>robot_state</strong> (<em>RobotState</em>) – Current robot state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gravity force vector [Nm] as numpy array (7,)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p>The gravity vector contains the joint torques required to compensate for gravitational forces.
This is provided for dynamics analysis and computation purposes. When using torque control,
gravity is automatically compensated by the controller, so you should not add gravity to your commands.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pylibfranka</span>

<span class="n">robot</span> <span class="o">=</span> <span class="n">pylibfranka</span><span class="o">.</span><span class="n">Robot</span><span class="p">(</span><span class="s2">&quot;172.16.0.2&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">load_model</span><span class="p">()</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">read_once</span><span class="p">()</span>

<span class="c1"># Compute gravity for analysis purposes</span>
<span class="n">gravity</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gravity torques [Nm]:&quot;</span><span class="p">,</span> <span class="n">gravity</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="mass">
<h3>mass<a class="headerlink" href="#mass" title="Permalink to this heading"></a></h3>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">Model.</span></span><span class="sig-name descname"><span class="pre">mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">robot_state</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Compute mass matrix <span class="math notranslate nohighlight">\(M(q)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>robot_state</strong> (<em>RobotState</em>) – Current robot state</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mass matrix [kg·m²] as numpy array (7, 7)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p>The mass matrix (also called inertia matrix) relates joint accelerations to joint torques.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pylibfranka</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">robot</span> <span class="o">=</span> <span class="n">pylibfranka</span><span class="o">.</span><span class="n">Robot</span><span class="p">(</span><span class="s2">&quot;172.16.0.2&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">load_model</span><span class="p">()</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">read_once</span><span class="p">()</span>

<span class="c1"># Compute mass matrix</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mass matrix shape:&quot;</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (7, 7)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mass matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

<span class="c1"># Example: Compute required torques for desired accelerations</span>
<span class="n">ddq_desired</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># [rad/s²]</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">M</span> <span class="o">@</span> <span class="n">ddq_desired</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Required torques:&quot;</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="zero-jacobian">
<h3>zero_jacobian<a class="headerlink" href="#zero-jacobian" title="Permalink to this heading"></a></h3>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">Model.</span></span><span class="sig-name descname"><span class="pre">zero_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">robot_state</span></span></em><span class="sig-paren">)</span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">Model.</span></span><span class="sig-name descname"><span class="pre">zero_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robot_state</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Compute zero Jacobian <span class="math notranslate nohighlight">\(^0J\)</span> for specified frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>Frame</em>) – Frame to compute Jacobian for (optional, default: end effector)</p></li>
<li><p><strong>robot_state</strong> (<em>RobotState</em>) – Current robot state</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Jacobian matrix as numpy array (6, 7)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
<p>The Jacobian maps joint velocities to end-effector twist (linear and angular velocities).</p>
<p>The returned Jacobian has shape (6, 7) where:</p>
<ul class="simple">
<li><p>Rows 0-2: Linear velocity mapping [m/s per rad/s]</p></li>
<li><p>Rows 3-5: Angular velocity mapping [rad/s per rad/s]</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pylibfranka</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">robot</span> <span class="o">=</span> <span class="n">pylibfranka</span><span class="o">.</span><span class="n">Robot</span><span class="p">(</span><span class="s2">&quot;172.16.0.2&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">load_model</span><span class="p">()</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">read_once</span><span class="p">()</span>

<span class="c1"># Compute end-effector Jacobian</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">zero_jacobian</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jacobian shape:&quot;</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (6, 7)</span>

<span class="c1"># Compute end-effector velocity from joint velocities</span>
<span class="n">dq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">dq</span><span class="p">)</span>  <span class="c1"># Joint velocities [rad/s]</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">J</span> <span class="o">@</span> <span class="n">dq</span>  <span class="c1"># End-effector twist [m/s, rad/s]</span>

<span class="n">v_linear</span> <span class="o">=</span> <span class="n">dx</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>   <span class="c1"># Linear velocity [m/s]</span>
<span class="n">w_angular</span> <span class="o">=</span> <span class="n">dx</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>  <span class="c1"># Angular velocity [rad/s]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear velocity [m/s]:&quot;</span><span class="p">,</span> <span class="n">v_linear</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Angular velocity [rad/s]:&quot;</span><span class="p">,</span> <span class="n">w_angular</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Robot</span></code> – Main robot interface (use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Robot.load_model()</span></code> to get Model)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RobotState</span></code> – Robot state used as input for dynamics computation</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ActiveControlBase</span></code> – Control interface for sending computed torques</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Franka Robotics GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>