<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>franka_bringup &mdash; Franka Control Interface (FCI) 0.6.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/style_override.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="franka_example_controllers" href="../../franka_example_controllers/doc/index.html" />
    <link rel="prev" title="franka_ros2" href="../../docs/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Franka Control Interface (FCI)
            <img src="../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../requirements.html">Minimum system and network requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compatibility.html">Compatible versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation_linux.html">Installation on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../libfranka.html">libfranka</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../franka_ros.html">franka_ros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/index.html">franka_ros2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../franka_toolbox_for_matlab/docs/franka_matlab/index.html">Franka Toolbox for MATLAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../control_parameters.html">Robot and interface specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fr3-certification-remarks.html">FR3 certification remarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Franka Control Interface (FCI)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../docs/index.html">franka_ros2</a> &raquo;</li>
      <li>franka_bringup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/franka_ros2/franka_bringup/doc/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="franka-bringup">
<h1>franka_bringup<a class="headerlink" href="#franka-bringup" title="Permalink to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">franka_ros2</span></code> is not supported on Windows.</p>
</div>
<p>The <a class="reference external" href="https://github.com/frankarobotics/franka_ros2">franka_ros2 repo</a> contains a ROS 2 integration of
<a class="reference external" href="https://frankarobotics.github.io/libfranka/">libfranka</a>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>franka_ros2 is in rapid development. Anticipate breaking changes. Report bugs on
<a class="reference external" href="https://github.com/frankarobotics/franka_ros2/issues">GitHub</a>.</p>
</div>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>Please refer to the <a class="reference external" href="https://github.com/frankarobotics/franka_ros2/blob/jazzy/README.md">README.md</a></p>
</section>
<section id="package-overview">
<h2>Package Overview<a class="headerlink" href="#package-overview" title="Permalink to this heading"></a></h2>
<p>This package contains the launch files for the examples as well as the basic <code class="docutils literal notranslate"><span class="pre">franka.launch.py</span></code> launch file, that
can be used to start the robot without any controllers.</p>
<p>When you start the robot with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">launch</span> <span class="n">franka_bringup</span> <span class="n">franka</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">arm_id</span><span class="o">:=</span><span class="n">fr3</span> <span class="n">robot_ip</span><span class="o">:=&lt;</span><span class="n">fci</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span> <span class="n">use_rviz</span><span class="o">:=</span><span class="n">true</span>
</pre></div>
</div>
<p>There is no controller running apart from the <code class="docutils literal notranslate"><span class="pre">joint_state_broadcaster</span></code>. However, a connection with the robot is still
established and the current robot pose is visualized in RViz. In this mode the robot can be guided when the user stop
button is pressed. However, once a controller that uses the <code class="docutils literal notranslate"><span class="pre">effort_command_interface</span></code> is started, the robot will be
using the torque interface from libfranka. For example it is possible to launch the
<code class="docutils literal notranslate"><span class="pre">gravity_compensation_example_controller</span></code> by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">control</span> <span class="n">load_controller</span> <span class="o">--</span><span class="nb">set</span><span class="o">-</span><span class="n">state</span> <span class="n">active</span>  <span class="n">gravity_compensation_example_controller</span>
</pre></div>
</div>
<p>This is the equivalent of running the <code class="docutils literal notranslate"><span class="pre">gravity_compensation_example_controller</span></code> example mentioned in
<a class="reference internal" href="../../franka_example_controllers/doc/index.html"><span class="doc">Gravity Compensation</span></a>.</p>
<p>When the controller is stopped with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">control</span> <span class="n">set_controller_state</span> <span class="n">gravity_compensation_example_controller</span> <span class="n">inactive</span>
</pre></div>
</div>
<p>the robot will stop the torque control and will only send its current state over the FCI.</p>
<p>You can now choose to start the same controller again with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">control</span> <span class="n">set_controller_state</span> <span class="n">gravity_compensation_example_controller</span> <span class="n">active</span>
</pre></div>
</div>
<p>or load and start a different one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">control</span> <span class="n">load_controller</span> <span class="o">--</span><span class="nb">set</span><span class="o">-</span><span class="n">state</span> <span class="n">active</span> <span class="n">joint_impedance_example_controller</span>
</pre></div>
</div>
</section>
<section id="namespace-enabled-launch-files">
<h2>Namespace enabled launch files<a class="headerlink" href="#namespace-enabled-launch-files" title="Permalink to this heading"></a></h2>
<p>To demonstrate how to launch the robot within a specified namespace, we provide an example launch file located at
<code class="docutils literal notranslate"><span class="pre">franka_bringup/launch/example.launch.py</span></code>.</p>
<p>By default <code class="docutils literal notranslate"><span class="pre">example.launch.py</span></code> file is configured to read essential robot configuration details from a YAML file, <code class="docutils literal notranslate"><span class="pre">franka.ns-config.yaml</span></code>,
located in the franka_bringup/launch/ directory. You may provide a different YAML file by specifying the path to it in the command line.</p>
<p><code class="docutils literal notranslate"><span class="pre">franka.ns-config.yaml</span></code> file specifies critical parameters, including:</p>
<ul class="simple">
<li><p>The path to the robot’s URDF file.</p></li>
<li><p>The namespace to be used for the robot instance.</p></li>
<li><p>Additional configuration details specific to the robot instance.</p></li>
</ul>
<p>example.launch.py “includes” <code class="docutils literal notranslate"><span class="pre">franka.ns-launch.py</span></code> which defines the core nodes typically required for robot operation..</p>
<p>The franka.ns-launch.py file, in turn, relies on <code class="docutils literal notranslate"><span class="pre">ns-controllers.yaml</span></code> to configure the ros2_controller framework.
This configuration ensures that controllers are loaded in a namespace-agnostic manner, supporting consistent behavior across multiple namespaces.</p>
<p>The ns-controllers.yaml file is designed to accommodate zero or more namespaces, provided all namespaces share the same node configuration parameters.</p>
<p>Each of the configuration and launch files (franka.ns-config.yaml, example.launch.py, franka.ns-launch.py, and ns-controllers.yaml)
contains detailed inline documentation to guide users through their structure and usage.  Further information about namespaces in ROS 2 can be found in the
<a class="reference external" href="https://docs.ros.org/en/jazzy/Tutorials/Intermediate/Launch/Using-ROS2-Launch-For-Large-Projects.html#namespaces">ROS 2 documentation</a>.</p>
<p>To execute any of the example controllers defined in ns-controllers.yaml, you can use the example.launch.py launch file and specify
the desired controller name as a command-line argument.</p>
<p>First - modify <code class="docutils literal notranslate"><span class="pre">franka.ns-config.yaml</span></code> as appropriate for your setup.</p>
<p>Then, for example, to run the <em>move_to_start_example_controller</em>, use the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>franka_bringup<span class="w"> </span>example.launch.py<span class="w"> </span>controller_name:<span class="o">=</span>move_to_start_example_controller
</pre></div>
</div>
</section>
<section id="non-realtime-robot-parameter-setting">
<h2>Non-realtime robot parameter setting<a class="headerlink" href="#non-realtime-robot-parameter-setting" title="Permalink to this heading"></a></h2>
<p>Non-realtime robot parameter setting can be done via ROS 2 services. They are advertised after the robot hardware is initialized.</p>
<p>Service names are given below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_cartesian_stiffness</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_force_torque_collision_behavior</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_full_collision_behavior</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_joint_stiffness</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_load</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_parameters</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_parameters_atomically</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_stiffness_frame</span>
<span class="o">*</span> <span class="o">/</span><span class="n">service_server</span><span class="o">/</span><span class="n">set_tcp_frame</span>
</pre></div>
</div>
<p>Service message descriptions are given below.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::srv::SetJointStiffness</span></code> specifies joint stiffness for the internal controller
(damping is automatically derived from the stiffness).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::srv::SetCartesianStiffness</span></code> specifies Cartesian stiffness for the internal
controller (damping is automatically derived from the stiffness).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::srv::SetTCPFrame</span></code> specifies the transformation from &lt;arm_id&gt;_EE (end effector) to
&lt;arm_id&gt;_NE (nominal end effector) frame. The transformation from flange to end effector frame
is split into two transformations: &lt;arm_id&gt;_EE to &lt;arm_id&gt;_NE frame and &lt;arm_id&gt;_NE to
&lt;arm_id&gt;_link8 frame. The transformation from &lt;arm_id&gt;_NE to &lt;arm_id&gt;_link8 frame can only be
set through the administrator’s interface.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::srv::SetStiffnessFrame</span></code> specifies the transformation from &lt;arm_id&gt;_K to &lt;arm_id&gt;_EE frame.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::srv::SetForceTorqueCollisionBehavior</span></code> sets thresholds for external Cartesian
wrenches to configure the collision reflex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::srv::SetFullCollisionBehavior</span></code> sets thresholds for external forces on Cartesian
and joint level to configure the collision reflex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::srv::SetLoad</span></code> sets an external load to compensate (e.g. of a grasped object).</p></li>
</ul>
</div></blockquote>
<p>Launch franka_bringup/franka.launch.py file to initialize robot hardware:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">launch</span> <span class="n">franka_bringup</span> <span class="n">franka</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">robot_ip</span><span class="o">:=&lt;</span><span class="n">fci</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Here is a minimal example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>service<span class="w"> </span>call<span class="w"> </span>/service_server/set_joint_stif
fness<span class="w"> </span>franka_msgs/srv/SetJointStiffness<span class="w"> </span><span class="s2">&quot;{joint_stiffness: [1000.0, 1000.0, 10</span>
<span class="s2">00.0, 1000.0, 1000.0, 1000.0, 1000.0]}&quot;</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Non-realtime parameter setting can only be done when the robot hardware is in <cite>idle</cite> mode.
If a controller is active and claims command interface this will put the robot in the <cite>move</cite> mode.
In <cite>move</cite> mode non-realtime param setting is not possible.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The &lt;arm_id&gt;_EE frame denotes the part of the
configurable end effector frame which can be adjusted during run time through <cite>franka_ros</cite>. The
&lt;arm_id&gt;_K frame marks the center of the internal
Cartesian impedance. It also serves as a reference frame for external wrenches. <em>Neither the
&lt;arm_id&gt;_EE nor the &lt;arm_id&gt;_K are contained in the URDF as they can be changed at run time</em>.
By default, &lt;arm_id&gt; is set to “panda”.</p>
<figure class="align-center" id="id1">
<img alt="../../../_images/frames1.svg" src="../../../_images/frames1.svg" /><figcaption>
<p><span class="caption-text">Overview of the end-effector frames.</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
</section>
<section id="non-realtime-ros-2-actions">
<h2>Non-realtime ROS 2 actions<a class="headerlink" href="#non-realtime-ros-2-actions" title="Permalink to this heading"></a></h2>
<p>Non-realtime ROS 2 actions can be done via the <cite>ActionServer</cite>. Following actions are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/action_server/error_recovery</span></code> - Recovers automatically from a robot error.</p></li>
</ul>
<p>The used messages are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">franka_msgs::action::ErrorRecovery</span></code> - no parameters.</p></li>
</ul>
<p>Example usage::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">action</span> <span class="n">send_goal</span> <span class="o">/</span><span class="n">action_server</span><span class="o">/</span><span class="n">error_recovery</span> <span class="n">franka_msgs</span><span class="o">/</span><span class="n">action</span><span class="o">/</span><span class="n">ErrorRecovery</span> <span class="p">{}</span>
</pre></div>
</div>
</section>
<section id="known-issues">
<h2>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>When using the <code class="docutils literal notranslate"><span class="pre">fake_hardware</span></code> with MoveIt, it takes some time until the default position is applied.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../docs/index.html" class="btn btn-neutral float-left" title="franka_ros2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../franka_example_controllers/doc/index.html" class="btn btn-neutral float-right" title="franka_example_controllers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Franka Robotics GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>